- name: Check process id of {{ item }}
  command: "pidof {{ item }}"
  register: pid1
  when: not dry_run

- debug:
    msg: "{{ pid1.stdout }}"
  when: not dry_run

- name: Kill process {{ item }}
  shell: "kill -9 {{ pid1.stdout }}"
  ignore_errors: no
  when: not dry_run

- name: Wait few seconds for GOES to come up
  pause:
    seconds: 10
  when: not dry_run

- name: Check goes status
  command: goes status
  register: goes_status
  ignore_errors: no
  when: not dry_run

- debug:
    msg: "{{ goes_status.stdout }}"
  when: not dry_run

- name: Check process id of {{ item }}
  command: "pidof {{ item }}"
  register: pid2
  when: not dry_run

- debug:
    msg: "{{ pid2.stdout }}"
  when: not dry_run

- name: Verify link status b/w invaders
  verify_links:
    switch_name: "{{ inventory_hostname }}"
    leaf_list: "{{ groups['leaf'] }}"
    eth_list: "1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31"
    platina_redis_channel: "{{ platina_redis_channel }}"
  register: link_status
  when: not dry_run

- name: Print Link Status
  debug:
    var: link_status
  when: not dry_run

- name: Wait few seconds for
  pause:
    seconds: 600
  when: not dry_run

- name: Check goes status
  command: goes status
  register: goes_status
  ignore_errors: no
  when: not dry_run

- debug:
    msg: "{{  goes_status.stdout }}"
  when: not dry_run

- name: Check process id of {{ item }}
  command: "pidof {{ item }}"
  register: pid3
  when: not dry_run

- debug:
    msg: "{{ pid3.stdout }}"
  when: not dry_run

- name: Kill process {{ item }}
  shell: "kill -9 {{ pid3.stdout }}"
  ignore_errors: no
  when: not dry_run

- name: Wait few seconds for GOES to come up
  pause:
    seconds: 10
  when: not dry_run

- name: Check goes status
  command: goes status
  register: goes_status
  ignore_errors: no
  when: not dry_run

- debug:
    msg: "{{ goes_status.stdout }}"
  when: not dry_run

- name: Check process id of {{ item }}
  command: "pidof {{ item }}"
  register: pid4
  when: not dry_run

- debug:
    msg: "{{ pid4.stdout }}"
  when: not dry_run

- name: Verify link status b/w invaders
  verify_links:
    switch_name: "{{ inventory_hostname }}"
    leaf_list: "{{ groups['leaf'] }}"
    eth_list: "1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31"
    platina_redis_channel: "{{ platina_redis_channel }}"
  register: link_status
  when: not dry_run

- name: Print Link Status
  debug:
    var: link_status
  when: not dry_run
